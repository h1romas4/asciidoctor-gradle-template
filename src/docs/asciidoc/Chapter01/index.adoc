include::../attribute.adoc[]

== Asciidoc 文書変換用スクリプトを使う準備

本手順で用いる Asciidoc 文書変換用スクリプトはビルドツールである Gradle を活用しており、実行するためには Java 実行環境が必要です。

お使いのコンピューターのコマンドライン環境（macOS/Linux ではターミナル、Windows では cmd.exe か powershell.exe）で ``java -version`` コマンドを入力し、Java 11 以上のバージョンが表示されるようであれば既に準備は整っています。

[source]
[caption=""]
.macOS/Linux の場合
----
$ java -version
openjdk 11.0.20.1 2023-08-24
OpenJDK Runtime Environment Temurin-11.0.20.1+1 (build 11.0.20.1+1)
OpenJDK 64-Bit Server VM Temurin-11.0.20.1+1 (build 11.0.20.1+1, mixed mode)
----

[source]
[caption=""]
.Windows の場合
----
C:¥> java -version
openjdk version "11.0.20.1" 2023-08-24
OpenJDK Runtime Environment Temurin-11.0.20.1+1 (build 11.0.20.1+1)
OpenJDK 64-Bit Server VM Temurin-11.0.20.1+1 (build 11.0.20.1+1, mixed mode)
----

NOTE: 本文書では Java 11 を用いて解説します。また、ビルド時に僅かに内部処理のワーニングが出力されますが Java 17 でも期待通り動作することを確認しています。

.Graphviz の導入
****
macOS 及び Linux の場合で、後述する PlantUML 以外のダイアグラム記法を使う場合は Graphviz の導入が必要です。この文書のサンプルソースでも使っている部分が一部ありますので、ワーニングなしに本文書の完全なファイルを生成したい場合は次のようにインストールしてください。Windows の場合、この操作は不要です。

[source, bash]
[caption=""]
.macOS
----
brew install graphviz
----

[source, bash]
[caption=""]
.Ubuntu
----
sudo apt install graphviz
----

****

<<<

=== Java 実行環境の導入（macOS / Linux の場合）

もし macOS / Linux 環境に Java 実行環境がなければ ``SDKMAN`` を利用することで、ターミナルから簡単に導入することができます。

[quote, SDKMAN]
____
https://sdkman.io/

SDKMAN! is a tool for managing parallel versions of multiple Software Development Kits on most Unix based systems.
____

[source]
[caption="手順. "]
.SDKMAN を用いた Java の導入
----
$ curl -s "https://get.sdkman.io" | bash # <1>
$ source "$HOME/.sdkman/bin/sdkman-init.sh" # <2>
$ sdk list java # <3>
================================================================================
Available Java Versions for Linux 64bit
================================================================================
 Vendor        | Use | Version      | Dist    | Status     | Identifier
--------------------------------------------------------------------------------
 Temurin       |     | 20.0.2       | tem     |            | 20.0.2-tem
               |     | 20.0.1       | tem     |            | 20.0.1-tem
               |     | 17.0.8       | tem     | installed  | 17.0.8-tem
               |     | 17.0.8.1     | tem     |            | 17.0.8.1-tem
               |     | 17.0.7       | tem     | installed  | 17.0.7-tem
               |     | 17.0.4       | tem     | local only | 17.0.4-tem
               |     | 11.0.20      | tem     |            | 11.0.20-tem
               | >>> | 11.0.20.1    | tem     | installed  | 11.0.20.1-tem
               |     | 11.0.19      | tem     | installed  | 11.0.19-tem
$ sdk install java 11.0.20.1-tem # <4>
----

<1> SDKMAN を導入します。
<2> SDKMAN を環境に設定します。
<3> 導入できる Java のバージョンを一覧します。
<4> Java 11 系の最新バージョンを指定して Java を導入します。

<<<

また、Gradle は ``JAVA_HOME`` 環境変数に実行環境の Java のパスが設定されていることを期待していますので、利用しているシェル環境に合わせ ``.bashrc`` や ``.zshrc`` 等で次のように ``JAVA_HOME`` を設定します。

[source]
[caption="手順. "]
.JAVA_HOME の設定
----
$ vi ~/.bashrc # <1>
export JAVA_HOME=~/.sdkman/candidates/java/current # <2>
$ source ~/.bashrc # <3>
----

<1> エディタで ``.bashrc`` や ``.zshrc`` を開きます。
<2> 本ラインをファイルの最下部に追加し保存終了します。
<3> 設定を適用します。`source` コマンドを使わず、ターミナルを再起動する操作でも反映されます。

以上で準備完了です。

.SDKMAN について
****
SDKMAN は主に Java エコシステムの開発環境をコマンドラインから簡単に導入・設定するためにつくたれた管理ソフトウェアです。

たとえば次のように簡単に各種 Java のバージョンを導入し切り替えることができます。

[source]
[caption="手順. "]
.SDKMAN による Java のバージョン切り替え
----
$ sdk install java 11.0.20.1-tem # <1>
$ sdk default java 11.0.20.1-tem # <2>
$ sdk default java 17.0.4.1-tem # <3>
----

<1> Java 11 を導入
<2> Java 11 をデフォルトに設定
<3> Java 17 をデフォルトに戻す
****

// 改ページ
<<<

=== Java 実行環境の導入（Windows の場合）

もし Windows 環境に Java 実行環境がなければ AdoptOpenJDK プロジェクトが提供する OpenJDK のバイナリを導入すると良いでしょう。

[quote, AdoptOpenJDK]
____
https://adoptopenjdk.net

Java™ is the world's leading programming language and platform. The code for Java is open source and available at OpenJDK™. AdoptOpenJDK provides prebuilt OpenJDK binaries from a fully open source set of build scripts and infrastructure.
____

``https://adoptopenjdk.net`` サイトにブラウザでアクセスし、OpenJDK 11 (LTS) - HotSpot を選択した後、zip ファイルをダウンロードしてください。

image::AdoptOpenJDK.png[adopt, pdfwidth=80%, width=80%]

<<<

zip ファイルを任意の場所に展開します。ここでは ``C:\develop\runtime\openjdk11`` に展開したとします。

image::windows-01.png[導入先, pdfwidth=70%, width=70%]

Gradle は ``JAVA_HOME`` 環境変数に実行環境の Java のパスが設定されていることを期待していますので、menu:エクスプローラー[PC（右クリック） > プロパティー > 詳細設定 > 環境設定] からユーザー環境変数に  ``JAVA_HOME`` を追加し、先ほど .zip を展開したパス（``C:\develop\runtime\openjdk11`` ）を設定します。

image::windows-02.png[環境変数, pdfwidth=60%, width=60%]

TIP: Gradle は JAVA_HOME 環境変数を元に Java の実行環境を探すため、``java`` コマンドを使うための PATH 環境変数は設定しなくてもかまいません。

以上で準備完了です。
